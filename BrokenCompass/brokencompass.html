<div class="character-sheet">

    <div class="row">
        <div class="col-8 character-details">

            <div class="flex">
                <label data-i18n="I-am">I am</label>
                <input type="text" class="transparent" name="attr_character_name" title="@{character_name}" spellcheck="false">
            </div>

            <div class="flex">
                <label data-i18n="call-me-if-you-need-a">Call me if you need a</label>
                <input type="text" class="transparent" name="attr_call_me">
            </div>

            <div class="flex center-inputs">
                <label data-i18n="place-i-call-home">Place I call home</label>
                <div class="input-with-subtext">
                    <input type="text" class="transparent">
                    <p data-i18n="heritage" name="attr_heritage">Heritage</p>
                </div>
                <div class="input-with-subtext">
                    <input type="text" class="transparent">
                    <p data-i18n="homeland" name="attr_homeland">Homeland</p>
                </div>
                <div class="input-with-subtext">
                    <input type="text" class="transparent">
                    <p data-i18n="workplace" name="attr_workplace">Workplace</p>
                </div>
            </div>

            <div class="input-with-subtext center-inputs">
                <input type="text" class="transparent" name="attr_motto">
                <p data-i18n="words-to-live-by">Words to live by</p>
            </div>
           
        </div>
        <div class="col-4">
			<br><br>

            <label class="secret-roll"><input type="checkbox" value="/w gm" name="attr_secret_roll"> <span data-i18n="make-the-roll-secret">Make the roll secret</span></label>

            <button type="roll" data-i18n="flip-the-coin" value="@{secret_roll} &{template:coin-flip} {{character_name=@{character_name}}} {{character_id=@{character_id}}} {{roll-name=coin-flip}} {{roll=[[1d2]]}}">Flip the coin</button>
        </div>
    </div>

    <div class="row">
        <div class="col-4">
            <div class="attribute-box">
                <div class="attribute-label">
                    <button type="action" name="act_roll" data-i18n="action" data-attribute="action" data-skill="">Action</button>

                    <input type="hidden" name="attr_action_calc" value="2">
                    <div class="diamond-checkboxes">
                        <input class="diamond-input" type="checkbox" name="attr_action" id="action_value_3" value="3" />
                        <label class="diamond-checkbox" for="action_value_3">
                            <span class="diamond-down"></span>
                        </label>

                        <input class="diamond-input" type="checkbox" name="attr_action" id="action_value_2" value="2" checked="checked" />
                        <label class="diamond-checkbox" for="action_value_2">
                            <span class="diamond-up"></span>
                        </label>

                        <input class="diamond-input" type="checkbox" name="attr_action" id="action_value_1" value="1" />
                        <label class="diamond-checkbox" for="action_value_1">
                            <span class="diamond-down"></span>
                        </label>
                    </div>
                </div>
                <div class="skill-box">
                    <div class="skill-label">
						<button type="action" name="act_roll" data-i18n="fight" data-attribute="action" data-skill="fight">Fight</button>

                        <input type="hidden" name="attr_fight_calc" value="1">
                        <div class="diamond-checkboxes">
                            <input class="diamond-input" type="checkbox" name="attr_fight" id="fight_value_3" value="3" />
                            <label class="diamond-checkbox" for="fight_value_3">
                                <span class="diamond-down"></span>
                            </label>

                            <input class="diamond-input" type="checkbox" name="attr_fight" id="fight_value_2" value="2" />
                            <label class="diamond-checkbox" for="fight_value_2">
                                <span class="diamond-up"></span>
                            </label>

                            <input class="diamond-input" type="checkbox" name="attr_fight" id="fight_value_1" value="1" checked="checked" />
                            <label class="diamond-checkbox" for="fight_value_1">
                                <span class="diamond-down"></span>
                            </label>
                        </div>
                    </div>

                    <div class="skill-label">
						<button type="action" name="act_roll" data-i18n="leadership" data-attribute="action" data-skill="leadership">Leadership</button>

                        <input type="hidden" name="attr_leadership_calc" value="1">
                        <div class="diamond-checkboxes">
                            <input class="diamond-input" type="checkbox" name="attr_leadership" id="leadership_value_3" value="3" />
                            <label class="diamond-checkbox" for="leadership_value_3">
                                <span class="diamond-down"></span>
                            </label>

                            <input class="diamond-input" type="checkbox" name="attr_leadership" id="leadership_value_2" value="2" />
                            <label class="diamond-checkbox" for="leadership_value_2">
                                <span class="diamond-up"></span>
                            </label>

                            <input class="diamond-input" type="checkbox" name="attr_leadership" id="leadership_value_1" value="1" checked="checked" />
                            <label class="diamond-checkbox" for="leadership_value_1">
                                <span class="diamond-down"></span>
                            </label>
                        </div>
                    </div>

                    <div class="skill-label">
                        <button type="action" name="act_roll" data-i18n="stunt" data-attribute="action" data-skill="stunt">Stunt</button>

                        <input type="hidden" name="attr_stunt_calc" value="1">
                        <div class="diamond-checkboxes">
                            <input class="diamond-input" type="checkbox" name="attr_stunt" id="stunt_value_3" value="3" />
                            <label class="diamond-checkbox" for="stunt_value_3">
                                <span class="diamond-down"></span>
                            </label>

                            <input class="diamond-input" type="checkbox" name="attr_stunt" id="stunt_value_2" value="2" />
                            <label class="diamond-checkbox" for="stunt_value_2">
                                <span class="diamond-up"></span>
                            </label>

                            <input class="diamond-input" type="checkbox" name="attr_stunt" id="stunt_value_1" value="1" checked="checked" />
                            <label class="diamond-checkbox" for="stunt_value_1">
                                <span class="diamond-down"></span>
                            </label>
                        </div>
                    </div>
                </div>
            </div>

			<div class="attribute-box">
                <div class="attribute-label">
                    <button type="action" name="act_roll" data-i18n="guts" data-attribute="guts" data-skill="">Guts</button>

                    <input type="hidden" name="attr_guts_calc" value="2">
                    <div class="diamond-checkboxes">
                        <input class="diamond-input" type="checkbox" name="attr_guts" id="guts_value_3" value="3" />
                        <label class="diamond-checkbox" for="guts_value_3">
                            <span class="diamond-down"></span>
                        </label>

                        <input class="diamond-input" type="checkbox" name="attr_guts" id="guts_value_2" value="2" checked="checked" />
                        <label class="diamond-checkbox" for="guts_value_2">
                            <span class="diamond-up"></span>
                        </label>

                        <input class="diamond-input" type="checkbox" name="attr_guts" id="guts_value_1" value="1" />
                        <label class="diamond-checkbox" for="guts_value_1">
                            <span class="diamond-down"></span>
                        </label>
                    </div>
                </div>
                <div class="skill-box">
                    <div class="skill-label">
						<button type="action" name="act_roll" data-i18n="cool" data-attribute="guts" data-skill="cool">cool</button>

                        <input type="hidden" name="attr_cool_calc" value="1">
                        <div class="diamond-checkboxes">
                            <input class="diamond-input" type="checkbox" name="attr_cool" id="cool_value_3" value="3" />
                            <label class="diamond-checkbox" for="cool_value_3">
                                <span class="diamond-down"></span>
                            </label>

                            <input class="diamond-input" type="checkbox" name="attr_cool" id="cool_value_2" value="2" />
                            <label class="diamond-checkbox" for="cool_value_2">
                                <span class="diamond-up"></span>
                            </label>

                            <input class="diamond-input" type="checkbox" name="attr_cool" id="cool_value_1" value="1" checked="checked" />
                            <label class="diamond-checkbox" for="cool_value_1">
                                <span class="diamond-down"></span>
                            </label>
                        </div>
                    </div>

                    <div class="skill-label">
						<button type="action" name="act_roll" data-i18n="drive" data-attribute="guts" data-skill="drive">drive</button>

                        <input type="hidden" name="attr_drive_calc" value="1">
                        <div class="diamond-checkboxes">
                            <input class="diamond-input" type="checkbox" name="attr_drive" id="drive_value_3" value="3" />
                            <label class="diamond-checkbox" for="drive_value_3">
                                <span class="diamond-down"></span>
                            </label>

                            <input class="diamond-input" type="checkbox" name="attr_drive" id="drive_value_2" value="2" />
                            <label class="diamond-checkbox" for="drive_value_2">
                                <span class="diamond-up"></span>
                            </label>

                            <input class="diamond-input" type="checkbox" name="attr_drive" id="drive_value_1" value="1" checked="checked" />
                            <label class="diamond-checkbox" for="drive_value_1">
                                <span class="diamond-down"></span>
                            </label>
                        </div>
                    </div>

                    <div class="skill-label">
                        <button type="action" name="act_roll" data-i18n="shoot" data-attribute="guts" data-skill="shoot">shoot</button>

                        <input type="hidden" name="attr_shoot_calc" value="1">
                        <div class="diamond-checkboxes">
                            <input class="diamond-input" type="checkbox" name="attr_shoot" id="shoot_value_3" value="3" />
                            <label class="diamond-checkbox" for="shoot_value_3">
                                <span class="diamond-down"></span>
                            </label>

                            <input class="diamond-input" type="checkbox" name="attr_shoot" id="shoot_value_2" value="2" />
                            <label class="diamond-checkbox" for="shoot_value_2">
                                <span class="diamond-up"></span>
                            </label>

                            <input class="diamond-input" type="checkbox" name="attr_shoot" id="shoot_value_1" value="1" checked="checked" />
                            <label class="diamond-checkbox" for="shoot_value_1">
                                <span class="diamond-down"></span>
                            </label>
                        </div>
                    </div>
                </div>
            </div>

			<div class="attribute-box">
                <div class="attribute-label">
                    <button type="action" name="act_roll" data-i18n="knowledge" data-attribute="knowledge" data-skill="">knowledge</button>

                    <input type="hidden" name="attr_knowledge_calc" value="2">
                    <div class="diamond-checkboxes">
                        <input class="diamond-input" type="checkbox" name="attr_knowledge" id="knowledge_value_3" value="3" />
                        <label class="diamond-checkbox" for="knowledge_value_3">
                            <span class="diamond-down"></span>
                        </label>

                        <input class="diamond-input" type="checkbox" name="attr_knowledge" id="knowledge_value_2" value="2" checked="checked" />
                        <label class="diamond-checkbox" for="knowledge_value_2">
                            <span class="diamond-up"></span>
                        </label>

                        <input class="diamond-input" type="checkbox" name="attr_knowledge" id="knowledge_value_1" value="1" />
                        <label class="diamond-checkbox" for="knowledge_value_1">
                            <span class="diamond-down"></span>
                        </label>
                    </div>
                </div>
                <div class="skill-box">
                    <div class="skill-label">
						<button type="action" name="act_roll" data-i18n="culture" data-attribute="knowledge" data-skill="culture">culture</button>

                        <input type="hidden" name="attr_culture_calc" value="1">
                        <div class="diamond-checkboxes">
                            <input class="diamond-input" type="checkbox" name="attr_culture" id="culture_value_3" value="3" />
                            <label class="diamond-checkbox" for="culture_value_3">
                                <span class="diamond-down"></span>
                            </label>

                            <input class="diamond-input" type="checkbox" name="attr_culture" id="culture_value_2" value="2" />
                            <label class="diamond-checkbox" for="culture_value_2">
                                <span class="diamond-up"></span>
                            </label>

                            <input class="diamond-input" type="checkbox" name="attr_culture" id="culture_value_1" value="1" checked="checked" />
                            <label class="diamond-checkbox" for="culture_value_1">
                                <span class="diamond-down"></span>
                            </label>
                        </div>
                    </div>

                    <div class="skill-label">
						<button type="action" name="act_roll" data-i18n="first_aid" data-attribute="knowledge" data-skill="first_aid">first_aid</button>

                        <input type="hidden" name="attr_first_aid_calc" value="1">
                        <div class="diamond-checkboxes">
                            <input class="diamond-input" type="checkbox" name="attr_first_aid" id="first_aid_value_3" value="3" />
                            <label class="diamond-checkbox" for="first_aid_value_3">
                                <span class="diamond-down"></span>
                            </label>

                            <input class="diamond-input" type="checkbox" name="attr_first_aid" id="first_aid_value_2" value="2" />
                            <label class="diamond-checkbox" for="first_aid_value_2">
                                <span class="diamond-up"></span>
                            </label>

                            <input class="diamond-input" type="checkbox" name="attr_first_aid" id="first_aid_value_1" value="1" checked="checked" />
                            <label class="diamond-checkbox" for="first_aid_value_1">
                                <span class="diamond-down"></span>
                            </label>
                        </div>
                    </div>

                    <div class="skill-label">
                        <button type="action" name="act_roll" data-i18n="tech" data-attribute="knowledge" data-skill="tech">tech</button>

                        <input type="hidden" name="attr_tech_calc" value="1">
                        <div class="diamond-checkboxes">
                            <input class="diamond-input" type="checkbox" name="attr_tech" id="tech_value_3" value="3" />
                            <label class="diamond-checkbox" for="tech_value_3">
                                <span class="diamond-down"></span>
                            </label>

                            <input class="diamond-input" type="checkbox" name="attr_tech" id="tech_value_2" value="2" />
                            <label class="diamond-checkbox" for="tech_value_2">
                                <span class="diamond-up"></span>
                            </label>

                            <input class="diamond-input" type="checkbox" name="attr_tech" id="tech_value_1" value="1" checked="checked" />
                            <label class="diamond-checkbox" for="tech_value_1">
                                <span class="diamond-down"></span>
                            </label>
                        </div>
                    </div>
                </div>
            </div>

			<div class="attribute-box">
                <div class="attribute-label">
                    <button type="action" name="act_roll" data-i18n="society" data-attribute="society" data-skill="">society</button>

                    <input type="hidden" name="attr_society_calc" value="2">
                    <div class="diamond-checkboxes">
                        <input class="diamond-input" type="checkbox" name="attr_society" id="society_value_3" value="3" />
                        <label class="diamond-checkbox" for="society_value_3">
                            <span class="diamond-down"></span>
                        </label>

                        <input class="diamond-input" type="checkbox" name="attr_society" id="society_value_2" value="2" checked="checked" />
                        <label class="diamond-checkbox" for="society_value_2">
                            <span class="diamond-up"></span>
                        </label>

                        <input class="diamond-input" type="checkbox" name="attr_society" id="society_value_1" value="1" />
                        <label class="diamond-checkbox" for="society_value_1">
                            <span class="diamond-down"></span>
                        </label>
                    </div>
                </div>
                <div class="skill-box">
                    <div class="skill-label">
						<button type="action" name="act_roll" data-i18n="charm" data-attribute="society" data-skill="charm">charm</button>

                        <input type="hidden" name="attr_charm_calc" value="1">
                        <div class="diamond-checkboxes">
                            <input class="diamond-input" type="checkbox" name="attr_charm" id="charm_value_3" value="3" />
                            <label class="diamond-checkbox" for="charm_value_3">
                                <span class="diamond-down"></span>
                            </label>

                            <input class="diamond-input" type="checkbox" name="attr_charm" id="charm_value_2" value="2" />
                            <label class="diamond-checkbox" for="charm_value_2">
                                <span class="diamond-up"></span>
                            </label>

                            <input class="diamond-input" type="checkbox" name="attr_charm" id="charm_value_1" value="1" checked="checked" />
                            <label class="diamond-checkbox" for="charm_value_1">
                                <span class="diamond-down"></span>
                            </label>
                        </div>
                    </div>

                    <div class="skill-label">
						<button type="action" name="act_roll" data-i18n="eloquence" data-attribute="society" data-skill="eloquence">eloquence</button>

                        <input type="hidden" name="attr_eloquence_calc" value="1">
                        <div class="diamond-checkboxes">
                            <input class="diamond-input" type="checkbox" name="attr_eloquence" id="eloquence_value_3" value="3" />
                            <label class="diamond-checkbox" for="eloquence_value_3">
                                <span class="diamond-down"></span>
                            </label>

                            <input class="diamond-input" type="checkbox" name="attr_eloquence" id="eloquence_value_2" value="2" />
                            <label class="diamond-checkbox" for="eloquence_value_2">
                                <span class="diamond-up"></span>
                            </label>

                            <input class="diamond-input" type="checkbox" name="attr_eloquence" id="eloquence_value_1" value="1" checked="checked" />
                            <label class="diamond-checkbox" for="eloquence_value_1">
                                <span class="diamond-down"></span>
                            </label>
                        </div>
                    </div>

                    <div class="skill-label">
                        <button type="action" name="act_roll" data-i18n="observation" data-attribute="society" data-skill="observation">observation</button>

                        <input type="hidden" name="attr_observation_calc" value="1">
                        <div class="diamond-checkboxes">
                            <input class="diamond-input" type="checkbox" name="attr_observation" id="observation_value_3" value="3" />
                            <label class="diamond-checkbox" for="observation_value_3">
                                <span class="diamond-down"></span>
                            </label>

                            <input class="diamond-input" type="checkbox" name="attr_observation" id="observation_value_2" value="2" />
                            <label class="diamond-checkbox" for="observation_value_2">
                                <span class="diamond-up"></span>
                            </label>

                            <input class="diamond-input" type="checkbox" name="attr_observation" id="observation_value_1" value="1" checked="checked" />
                            <label class="diamond-checkbox" for="observation_value_1">
                                <span class="diamond-down"></span>
                            </label>
                        </div>
                    </div>
                </div>
            </div>

			<div class="attribute-box">
                <div class="attribute-label">
                    <button type="action" name="act_roll" data-i18n="wild" data-attribute="wild" data-skill="">wild</button>

                    <input type="hidden" name="attr_wild_calc" value="2">
                    <div class="diamond-checkboxes">
                        <input class="diamond-input" type="checkbox" name="attr_wild" id="wild_value_3" value="3" />
                        <label class="diamond-checkbox" for="wild_value_3">
                            <span class="diamond-down"></span>
                        </label>

                        <input class="diamond-input" type="checkbox" name="attr_wild" id="wild_value_2" value="2" checked="checked" />
                        <label class="diamond-checkbox" for="wild_value_2">
                            <span class="diamond-up"></span>
                        </label>

                        <input class="diamond-input" type="checkbox" name="attr_wild" id="wild_value_1" value="1" />
                        <label class="diamond-checkbox" for="wild_value_1">
                            <span class="diamond-down"></span>
                        </label>
                    </div>
                </div>
                <div class="skill-box">
                    <div class="skill-label">
						<button type="action" name="act_roll" data-i18n="scout" data-attribute="wild" data-skill="scout">scout</button>

                        <input type="hidden" name="attr_scout_calc" value="1">
                        <div class="diamond-checkboxes">
                            <input class="diamond-input" type="checkbox" name="attr_scout" id="scout_value_3" value="3" />
                            <label class="diamond-checkbox" for="scout_value_3">
                                <span class="diamond-down"></span>
                            </label>

                            <input class="diamond-input" type="checkbox" name="attr_scout" id="scout_value_2" value="2" />
                            <label class="diamond-checkbox" for="scout_value_2">
                                <span class="diamond-up"></span>
                            </label>

                            <input class="diamond-input" type="checkbox" name="attr_scout" id="scout_value_1" value="1" checked="checked" />
                            <label class="diamond-checkbox" for="scout_value_1">
                                <span class="diamond-down"></span>
                            </label>
                        </div>
                    </div>

                    <div class="skill-label">
						<button type="action" name="act_roll" data-i18n="survival" data-attribute="wild" data-skill="survival">survival</button>

                        <input type="hidden" name="attr_survival_calc" value="1">
                        <div class="diamond-checkboxes">
                            <input class="diamond-input" type="checkbox" name="attr_survival" id="survival_value_3" value="3" />
                            <label class="diamond-checkbox" for="survival_value_3">
                                <span class="diamond-down"></span>
                            </label>

                            <input class="diamond-input" type="checkbox" name="attr_survival" id="survival_value_2" value="2" />
                            <label class="diamond-checkbox" for="survival_value_2">
                                <span class="diamond-up"></span>
                            </label>

                            <input class="diamond-input" type="checkbox" name="attr_survival" id="survival_value_1" value="1" checked="checked" />
                            <label class="diamond-checkbox" for="survival_value_1">
                                <span class="diamond-down"></span>
                            </label>
                        </div>
                    </div>

                    <div class="skill-label">
                        <button type="action" name="act_roll" data-i18n="tough" data-attribute="wild" data-skill="tough">tough</button>

                        <input type="hidden" name="attr_tough_calc" value="1">
                        <div class="diamond-checkboxes">
                            <input class="diamond-input" type="checkbox" name="attr_tough" id="tough_value_3" value="3" />
                            <label class="diamond-checkbox" for="tough_value_3">
                                <span class="diamond-down"></span>
                            </label>

                            <input class="diamond-input" type="checkbox" name="attr_tough" id="tough_value_2" value="2" />
                            <label class="diamond-checkbox" for="tough_value_2">
                                <span class="diamond-up"></span>
                            </label>

                            <input class="diamond-input" type="checkbox" name="attr_tough" id="tough_value_1" value="1" checked="checked" />
                            <label class="diamond-checkbox" for="tough_value_1">
                                <span class="diamond-down"></span>
                            </label>
                        </div>
                    </div>
                </div>
            </div>

			<div class="attribute-box">
                <div class="attribute-label">
                    <button type="action" name="act_roll" data-i18n="crime" data-attribute="crime" data-skill="">crime</button>

                    <input type="hidden" name="attr_crime_calc" value="2">
                    <div class="diamond-checkboxes">
                        <input class="diamond-input" type="checkbox" name="attr_crime" id="crime_value_3" value="3" />
                        <label class="diamond-checkbox" for="crime_value_3">
                            <span class="diamond-down"></span>
                        </label>

                        <input class="diamond-input" type="checkbox" name="attr_crime" id="crime_value_2" value="2" checked="checked" />
                        <label class="diamond-checkbox" for="crime_value_2">
                            <span class="diamond-up"></span>
                        </label>

                        <input class="diamond-input" type="checkbox" name="attr_crime" id="crime_value_1" value="1" />
                        <label class="diamond-checkbox" for="crime_value_1">
                            <span class="diamond-down"></span>
                        </label>
                    </div>
                </div>
                <div class="skill-box">
                    <div class="skill-label">
						<button type="action" name="act_roll" data-i18n="caution" data-attribute="crime" data-skill="caution">caution</button>

                        <input type="hidden" name="attr_caution_calc" value="1">
                        <div class="diamond-checkboxes">
                            <input class="diamond-input" type="checkbox" name="attr_caution" id="caution_value_3" value="3" />
                            <label class="diamond-checkbox" for="caution_value_3">
                                <span class="diamond-down"></span>
                            </label>

                            <input class="diamond-input" type="checkbox" name="attr_caution" id="caution_value_2" value="2" />
                            <label class="diamond-checkbox" for="caution_value_2">
                                <span class="diamond-up"></span>
                            </label>

                            <input class="diamond-input" type="checkbox" name="attr_caution" id="caution_value_1" value="1" checked="checked" />
                            <label class="diamond-checkbox" for="caution_value_1">
                                <span class="diamond-down"></span>
                            </label>
                        </div>
                    </div>

                    <div class="skill-label">
						<button type="action" name="act_roll" data-i18n="dexterity" data-attribute="crime" data-skill="dexterity">dexterity</button>

                        <input type="hidden" name="attr_dexterity_calc" value="1">
                        <div class="diamond-checkboxes">
                            <input class="diamond-input" type="checkbox" name="attr_dexterity" id="dexterity_value_3" value="3" />
                            <label class="diamond-checkbox" for="dexterity_value_3">
                                <span class="diamond-down"></span>
                            </label>

                            <input class="diamond-input" type="checkbox" name="attr_dexterity" id="dexterity_value_2" value="2" />
                            <label class="diamond-checkbox" for="dexterity_value_2">
                                <span class="diamond-up"></span>
                            </label>

                            <input class="diamond-input" type="checkbox" name="attr_dexterity" id="dexterity_value_1" value="1" checked="checked" />
                            <label class="diamond-checkbox" for="dexterity_value_1">
                                <span class="diamond-down"></span>
                            </label>
                        </div>
                    </div>

                    <div class="skill-label">
                        <button type="action" name="act_roll" data-i18n="stealth" data-attribute="crime" data-skill="stealth">stealth</button>

                        <input type="hidden" name="attr_stealth_calc" value="1">
                        <div class="diamond-checkboxes">
                            <input class="diamond-input" type="checkbox" name="attr_stealth" id="stealth_value_3" value="3" />
                            <label class="diamond-checkbox" for="stealth_value_3">
                                <span class="diamond-down"></span>
                            </label>

                            <input class="diamond-input" type="checkbox" name="attr_stealth" id="stealth_value_2" value="2" />
                            <label class="diamond-checkbox" for="stealth_value_2">
                                <span class="diamond-up"></span>
                            </label>

                            <input class="diamond-input" type="checkbox" name="attr_stealth" id="stealth_value_1" value="1" checked="checked" />
                            <label class="diamond-checkbox" for="stealth_value_1">
                                <span class="diamond-down"></span>
                            </label>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-8">

            <div class="row">
                <div class="col-7">
                    <div class="luck-box">
						<div class="luck-box-inner"> 
							<label class="title-label" data-i18n="luck">Luck</label>
							<input class="circle-input" type="checkbox" name="attr_luck" id="luck_value_1" value="10" />
							<input class="circle-input" type="checkbox" name="attr_luck" id="luck_value_1" value="9" />
							<input class="circle-input" type="checkbox" name="attr_luck" id="luck_value_1" value="8" />
							<input class="circle-input" type="checkbox" name="attr_luck" id="luck_value_1" value="7" />
							<input class="circle-input" type="checkbox" name="attr_luck" id="luck_value_1" value="6" />
							<input class="circle-input" type="checkbox" name="attr_luck" id="luck_value_1" value="5" />
							<input class="circle-input" type="checkbox" name="attr_luck" id="luck_value_1" value="4" />
							<input class="circle-input" type="checkbox" name="attr_luck" id="luck_value_1" value="3" />
							<input class="circle-input" type="checkbox" name="attr_luck" id="luck_value_1" value="2" />
							<input class="circle-input" type="checkbox" name="attr_luck" id="luck_value_1" value="1" />
						</div>
						<div class="luck-input-box">
							<input type="text" class="luck-input" name="attr_luck_number">
						</div>
                    </div>
                </div>

                <div class="col-5">
                    <img src="https://raw.githubusercontent.com/Velczer/CharacterSheets/master/BrokenCompass/Images/logo.png" alt="">
                </div>
            </div>


            <div class="row">
                <div class="col-8" style="margin-bottom: 50px;">
                    <label class="title-label center" data-i18n="i-feel">I feel</label>

                    <div class="feel-box">
                        <div class="feel-input">
                            <input type="checkbox" class="diamond-input" name="attr_action_modifier" id="attr_action_modifier-plus" value="1">
                            <label class="diamond-checkbox" for="attr_action_modifier-plus"><span class="diamond-down"><span data-i18n="powerful">Powerful</span> <i>+</i></span></label>
                        </div>
                        <span data-i18n="action">Action</span>
                        <div class="feel-input ">
                            <input type="checkbox" class="diamond-input" name="attr_action_modifier" id="attr_action_modifier-minus" value="-1">
                            <label class="diamond-checkbox" for="attr_action_modifier-minus"><span class="diamond-up"><span data-i18n="bleeding">Bleeding</span> <i>-</i></span></label>
                        </div>
                    </div>

                    <div class="feel-box">
                        <div class="feel-input">
                            <input type="checkbox" class="diamond-input" name="attr_guts_modifier" id="attr_guts_modifier-plus" value="1">
                            <label class="diamond-checkbox" for="attr_guts_modifier-plus"><span class="diamond-down"><span data-i18n="daring">Daring</span> <i>+</i></span></label>
                        </div>
                        <span data-i18n="guts">Guts</span>
                        <div class="feel-input">
                            <input type="checkbox" class="diamond-input" name="attr_guts_modifier" id="attr_guts_modifier-minus" value="-1">
                            <label class="diamond-checkbox" for="attr_guts_modifier-minus"><span class="diamond-up"><span data-i18n="shocked">Shocked</span> <i>-</i></span></label>
                        </div>
                    </div>

                    <div class="feel-box">
                        <div class="feel-input">
                            <input type="checkbox" class="diamond-input" name="attr_knowledge_modifier" id="attr_knowledge_modifier-plus" value="1">
                            <label class="diamond-checkbox" for="attr_knowledge_modifier-plus"><span class="diamond-down"><span data-i18n="focused">Focused</span> <i>+</i></span></label>
                        </div>
                        <span data-i18n="knowledge">Knowledge</span>
                        <div class="feel-input ">
                            <input type="checkbox" class="diamond-input" name="attr_knowledge_modifier" id="attr_knowledge_modifier-minus" value="-1">
                            <label class="diamond-checkbox" for="attr_knowledge_modifier-minus"><span class="diamond-up"><span data-i18n="dizzy">Dizzy</span> <i>-</i></span></label>
                        </div>
                    </div>

					<div class="feel-box">
                        <div class="feel-input">
                            <input type="checkbox" class="diamond-input" name="attr_society_modifier" id="attr_society_modifier-plus" value="1">
                            <label class="diamond-checkbox" for="attr_society_modifier-plus"><span class="diamond-down"><span data-i18n="confident">Confident</span> <i>+</i></span></label>
                        </div>
                        <span data-i18n="society">Society</span>
                        <div class="feel-input ">
                            <input type="checkbox" class="diamond-input" name="attr_society_modifier" id="attr_society_modifier-minus" value="-1">
                            <label class="diamond-checkbox" for="attr_society_modifier-minus"><span class="diamond-up"><span data-i18n="embarassed">Embarassed</span> <i>-</i></span></label>
                        </div>
                    </div>

					<div class="feel-box">
                        <div class="feel-input">
                            <input type="checkbox" class="diamond-input" name="attr_wild_modifier" id="attr_wild_modifier-plus" value="1">
                            <label class="diamond-checkbox" for="attr_wild_modifier-plus"><span class="diamond-down"><span data-i18n="fierce">Fierce</span> <i>+</i></span></label>
                        </div>
                        <span data-i18n="wild">Wild</span>
                        <div class="feel-input ">
                            <input type="checkbox" class="diamond-input" name="attr_wild_modifier" id="attr_wild_modifier-minus" value="-1">
                            <label class="diamond-checkbox" for="attr_wild_modifier-minus"><span class="diamond-up"><span data-i18n="broken">Broken</span> <i>-</i></span></label>
                        </div>
                    </div>

					<div class="feel-box">
                        <div class="feel-input">
                            <input type="checkbox" class="diamond-input" name="attr_crime_modifier" id="attr_crime_modifier-plus" value="1">
                            <label class="diamond-checkbox" for="attr_crime_modifier-plus"><span class="diamond-down"><span data-i18n="untouchable">Untouchable</span> <i>+</i></span></label>
                        </div>
                        <span data-i18n="crime">Crime</span>
                        <div class="feel-input ">
                            <input type="checkbox" class="diamond-input" name="attr_crime_modifier" id="attr_crime_modifier-minus" value="-1">
                            <label class="diamond-checkbox" for="attr_crime_modifier-minus"><span class="diamond-up"><span data-i18n="scared">Scared</span> <i>-</i></span></label>
                        </div>
                    </div>
                </div>

                <div class="col-4 expertise-box">
					<img class="expertise-img" src="https://raw.githubusercontent.com/Velczer/CharacterSheets/master/BrokenCompass/Images/scythe.png" alt="">
					<label class="subtitle-label" data-i18n="expertise">Expertise</label>
					<div class="repitem">
						<input type="text" name="attr_expertise_default">
					</div>

					<fieldset class="repeating_expertise">
						<input class="flex-1" type="text" name="attr_expertise_name">
					</fieldset>
                </div>
            </div>

			<div class="row">
				<div class="col-12">
					<div class="weapon-and-gear-title">
						<label class="title-label" data-i18n="weapon-and-gear">Weapon & Gear</label>
						<img class="weapon-and-gear-img" src="https://raw.githubusercontent.com/Velczer/CharacterSheets/master/BrokenCompass/Images/hook.png" alt="">
					</div>

                    <div class="fieldset-labels center">
                        <span class="flex-1 mini-title" data-i18n="name">Name</span>
                        <span class="flex-2 mini-title" data-i18n="description">Description</span>
                    </div>

					<div class="gear-rep-list">
						<fieldset class="repeating_gear">
							<input class="flex-1 gear-input" type="text" name="attr_gear_name">
							<input class="flex-2" type="text" name="attr_gear_desc">
						</fieldset>
					</div>
				</div>
			</div>
            
        </div>
    </div>

	<div class="row">
		<div class="col-4">
			<label class="subtitle-label" data-i18n="scars-and-experiences">Scars and Experiences</label>

			<fieldset class="repeating_scars">
				<input class="flex-1" type="text" name="attr_scars">
			</fieldset>
		</div>

		<div class="col-4">
			<label class="subtitle-label" data-i18n="pockets">Pockets</label>
			<fieldset class="repeating_pockets">
				<input class="flex-1" type="text" name="attr_pockets">
			</fieldset>

			<label class="subtitle-label" data-i18n="bag">Bag</label>
			<fieldset class="repeating_bag">
				<input class="flex-1" type="text" name="attr_bag">
			</fieldset>
		</div>

		<div class="col-4">
			<div class="backpack-box">
				<label class="subtitle-label" data-i18n="backpack">backpack</label>
				<img class="backpack-img" src="https://raw.githubusercontent.com/Velczer/CharacterSheets/master/BrokenCompass/Images/backpack.png" alt="">
				<fieldset class="repeating_backpack">
					<input class="flex-1" type="text" name="attr_backpack">
				</fieldset>
			</div>

			<label class="subtitle-label" data-i18n="mags">Mags</label>
			<div class="fieldset-labels center">
				<span class="flex-3 mini-title"></span>
				<span class="flex-1 mini-title" data-i18n="pockets">pockets</span>
				<span class="flex-1 mini-title" data-i18n="bag">bag</span>
				<span class="flex-1 mini-title" data-i18n="backpack">backpack</span>
			</div>
			<fieldset class="repeating_mag">
				<input class="flex-3" type="text" name="attr_mag_name">
				<input class="flex-1" type="number" max="2" name="attr_mag_pockets">
				<input class="flex-1" type="number" max="2" name="attr_mag_bag">
				<input class="flex-1" type="number" max="9" name="attr_mag_backpack">
			</fieldset>
			<div class="fieldset-labels mag-max-clips">
				<span class="flex-3 mini-title"></span>
				<span class="flex-1 mini-title">/2</span>
				<span class="flex-1 mini-title">/2</span>
				<span class="flex-1 mini-title">/9</span>
			</div>
		</div>
	</div>

    <input type="hidden" name="attr_null_calc" value="0">
</div>



<!-- Roll Templates -->

<rolltemplate class="sheet-rolltemplate-coin-flip">
    <div class="template-wrap">
        <div class="template-subtitle">
            {{roll-name}}
        </div>

        <div class="template-grid-item-flex">
            <div class="template-roll-between">{{roll}}</div>
        </div>

        {{#rollWasCrit}}
        <div class="template-grid-item-flex">
            <img src="" alt="">
        </div>
        {{/rollWasCrit}}

        {{#rollWasFumble}}
        <div class="template-grid-item-flex">
            <img src="" alt="">
        </div>
        {{/rollWasFumble}}



    </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-brokencompass">

    <h4>dices = {{dices}}</h4>

	<div class="template-wrap">
		<div class="template-header">
			{{#character_name}}
			{{#character_id}}[{{character_name}}](https://journal.roll20.net/character/{{character_id}}){{/character_id}}
			{{^character_id}}{{character_name}}{{/character_id}}
			{{/character_name}}
		</div>

        <div class="template-subtitle">
            {{roll-name}}
        </div>

        <div class="template-grid-item-flex">
		    <label class="template-label" data-i18n="total-dices:">Total dices:</label>
            <div class="template-roll-between">{{baseDice}}</div>
        </div>

        <div class="template-grid-item-flex">
            <label class="template-label" data-i18n="equal-dice:">Equal dice:</label>
        </div>

        <div class="template-grid-item-box">
            {{#rollGreater() computed::pair_of_one 1}}
            <div class="template-grid-item">
                <div class="template-roll-between"><span class="template-roll-dice">1</span></div>
                <div class="template-roll-between"><span class="template-roll-dice">1</span></div>
                {{#rollGreater() computed::pair_of_one 2}}
                    <div class="template-roll-between"><span class="template-roll-dice">1</span></div>
                {{/rollGreater() computed::pair_of_one 2}}

                {{#rollGreater() computed::pair_of_one 3}}
                    <div class="template-roll-between"><span class="template-roll-dice">1</span></div>
                {{/rollGreater() computed::pair_of_one 3}}

                {{#rollGreater() computed::pair_of_one 4}}
                    <div class="template-roll-between"><span class="template-roll-dice">1</span></div>
                {{/rollGreater() computed::pair_of_one 4}}

                {{#rollGreater() computed::pair_of_one 5}}
                    <div class="template-roll-between"><span class="template-roll-dice">1</span></div>
                {{/rollGreater() computed::pair_of_one 5}}

            </div>
            {{/rollGreater() computed::pair_of_one 1}}

            {{#rollGreater() computed::pair_of_two 1}}
            <div class="template-grid-item">
                <div class="template-roll-between"><span class="template-roll-dice">2</span></div>
                <div class="template-roll-between"><span class="template-roll-dice">2</span></div>

                {{#rollGreater() computed::pair_of_two 2}}
                    <div class="template-roll-between"><span class="template-roll-dice">2</span></div>
                {{/rollGreater() computed::pair_of_two 2}}

                {{#rollGreater() computed::pair_of_two 3}}
                    <div class="template-roll-between"><span class="template-roll-dice">2</span></div>
                {{/rollGreater() computed::pair_of_two 3}}

                {{#rollGreater() computed::pair_of_two 4}}
                    <div class="template-roll-between"><span class="template-roll-dice">2</span></div>
                {{/rollGreater() computed::pair_of_two 4}}

                {{#rollGreater() computed::pair_of_two 5}}
                    <div class="template-roll-between"><span class="template-roll-dice">2</span></div>
                {{/rollGreater() computed::pair_of_two 5}}
            </div>
            {{/rollGreater() computed::pair_of_two 1}}

            {{#rollGreater() computed::pair_of_three 1}}
            <div class="template-grid-item">
                <div class="template-roll-between"><span class="template-roll-dice">3</span></div>
                <div class="template-roll-between"><span class="template-roll-dice">3</span></div>

                {{#rollGreater() computed::pair_of_three 2}}
                    <div class="template-roll-between"><span class="template-roll-dice">3</span></div>
                {{/rollGreater() computed::pair_of_three 2}}

                {{#rollGreater() computed::pair_of_three 3}}
                    <div class="template-roll-between"><span class="template-roll-dice">3</span></div>
                {{/rollGreater() computed::pair_of_three 3}}

                {{#rollGreater() computed::pair_of_three 4}}
                    <div class="template-roll-between"><span class="template-roll-dice">3</span></div>
                {{/rollGreater() computed::pair_of_three 4}}

                {{#rollGreater() computed::pair_of_three 5}}
                    <div class="template-roll-between"><span class="template-roll-dice">3</span></div>
                {{/rollGreater() computed::pair_of_three 5}}
            </div>
            {{/rollGreater() computed::pair_of_three 1}}

            {{#rollGreater() computed::pair_of_four 1}}
            <div class="template-grid-item">
                <div class="template-roll-between"><span class="template-roll-dice">4</span></div>
                <div class="template-roll-between"><span class="template-roll-dice">4</span></div>

                {{#rollGreater() computed::pair_of_four 2}}
                    <div class="template-roll-between"><span class="template-roll-dice">4</span></div>
                {{/rollGreater() computed::pair_of_four 2}}

                {{#rollGreater() computed::pair_of_four 3}}
                    <div class="template-roll-between"><span class="template-roll-dice">4</span></div>
                {{/rollGreater() computed::pair_of_four 3}}

                {{#rollGreater() computed::pair_of_four 4}}
                    <div class="template-roll-between"><span class="template-roll-dice">4</span></div>
                {{/rollGreater() computed::pair_of_four 4}}

                {{#rollGreater() computed::pair_of_four 5}}
                    <div class="template-roll-between"><span class="template-roll-dice">4</span></div>
                {{/rollGreater() computed::pair_of_four 5}}

            </div>
            {{/rollGreater() computed::pair_of_four 1}}

            {{#rollGreater() computed::pair_of_five 1}}
            <div class="template-grid-item">
                <div class="template-roll-between"><span class="template-roll-dice">5</span></div>
                <div class="template-roll-between"><span class="template-roll-dice">5</span></div>

                {{#rollGreater() computed::pair_of_five 2}}
                    <div class="template-roll-between"><span class="template-roll-dice">5</span></div>
                {{/rollGreater() computed::pair_of_five 2}}

                {{#rollGreater() computed::pair_of_five 3}}
                    <div class="template-roll-between"><span class="template-roll-dice">5</span></div>
                {{/rollGreater() computed::pair_of_five 3}}

                {{#rollGreater() computed::pair_of_five 4}}
                    <div class="template-roll-between"><span class="template-roll-dice">5</span></div>
                {{/rollGreater() computed::pair_of_five 4}}

                {{#rollGreater() computed::pair_of_five 5}}
                    <div class="template-roll-between"><span class="template-roll-dice">5</span></div>
                {{/rollGreater() computed::pair_of_five 5}}
            </div>
            {{/rollGreater() computed::pair_of_five 1}}

            {{#rollGreater() computed::pair_of_six 1}}
            <div class="template-grid-item">
                <div class="template-roll-between"><span class="template-roll-dice">6</span></div>
                <div class="template-roll-between"><span class="template-roll-dice">6</span></div>

                {{#rollGreater() computed::pair_of_six 2}}
                    <div class="template-roll-between"><span class="template-roll-dice">6</span></div>
                {{/rollGreater() computed::pair_of_six 2}}

                {{#rollGreater() computed::pair_of_six 3}}
                    <div class="template-roll-between"><span class="template-roll-dice">6</span></div>
                {{/rollGreater() computed::pair_of_six 3}}

                {{#rollGreater() computed::pair_of_six 4}}
                    <div class="template-roll-between"><span class="template-roll-dice">6</span></div>
                {{/rollGreater() computed::pair_of_six 4}}

                {{#rollGreater() computed::pair_of_six 5}}
                    <div class="template-roll-between"><span class="template-roll-dice">6</span></div>
                {{/rollGreater() computed::pair_of_six 5}}
            </div>
            {{/rollGreater() computed::pair_of_six 1}}
        </div>

        <div class="template-grid-item-flex">
		    <label class="template-label" data-i18n="basic:">Basic:</label>
            <div class="template-roll-between">{{computed::basic_success}}</div>
        </div>

        <div class="template-grid-item-flex">
		    <label class="template-label" data-i18n="critical:">Critical:</label>
            <div class="template-roll-between">{{computed::critical_success}}</div>
        </div>

        <div class="template-grid-item-flex">
		    <label class="template-label" data-i18n="extreme:">Extreme:</label>
            <div class="template-roll-between">{{computed::extreme_success}}</div>
        </div>

        <div class="template-grid-item-flex">
		    <label class="template-label" data-i18n="impossible:">Impossible:</label>
            <div class="template-roll-between">{{computed::impossible_success}}</div>
        </div>

        <div class="template-grid-item-flex">
            {{#expertise}}
            <div class="sheet-rolltemplate-button-row">
                <div class="sheet-rolltemplate-button">
                    [<span data-i18n="i-have-expertise"></span>](~{{character_name}}|roll||{{attribute}}|{{skill}})
                </div>
            </div>
            {{/expertise}}

        </div>
	</div>
</rolltemplate>

<script type="text/worker">

	const stats = ["action", "fight", "leadership", "stunt"];

	stats.forEach(stat => {
		on(`change:${stat}`, () => {
			getAttrs([stat], values => {
				const stat_base = values[stat]; 
				
				getAttrs([`${stat}_calc`], function(test) {
					setAttrs({
						[`${stat}_calc`]: stat_base
					}); 
				});
				
			});
		});
	});

    on('clicked:roll', async (info) => {
        console.log(info)

        var expertise = true;
        if (info.originalRollId != null) {
            var attr_and_skill = info.originalRollId.split('|');
            var attribute = attr_and_skill[0];
            var skill = attr_and_skill[1];
            expertise = '';
        } else {
            var attribute = info.htmlAttributes['data-attribute'];
            var skill = info.htmlAttributes['data-skill'];
        }

		var rollName = attribute;

		if (skill == '') {
			skill = 'null';
		} else {
			rollName = skill;
		}

		const rollBase = '@{secret_roll} &{template:brokencompass} {{character_name=@{character_name}}} {{character_id=@{character_id}}} {{name=^{dice-pool}}} {{attribute='+attribute+'}} {{skill='+skill+'}} {{expertise='+expertise+'}} {{roll-name=^{'+rollName+'} }} {{baseDice=[[ @{'+attribute+'_calc} + @{'+skill+'_calc} + @{'+attribute+'_modifier} + ?{Modifiers|0} ]] }} {{dices=[[(@{'+attribute+'_calc} + @{'+skill+'_calc} + @{'+attribute+'_modifier} + ?{Modifiers|0})d6m]]}} {{pair_of_one=[[1d6]]}} {{pair_of_two=[[1d6]]}} {{pair_of_three=[[1d6]]}} {{pair_of_four=[[1d6]]}} {{pair_of_five=[[1d6]]}} {{pair_of_six=[[1d6]]}} {{basic_success=[[1d6]]}} {{critical_success=[[1d6]]}} {{extreme_success=[[1d6]]}} {{impossible_success=[[1d6]]}}';

        var table = [0,0,0,0,0,0,0];

        let rollResult = await startRoll(rollBase);

        let computedValues = await checkPairs(rollResult);

        finishRoll(
            rollResult.rollId,
            computedValues
        );
    });

    // Helper for check pairs and successes
    const checkPairs = async (rollResult) => {
        const dices	= rollResult.results.dices.dice;

        var table = [0,0,0,0,0,0,0];

        for (i = 0; dices.length > i; i++) {
            table[dices[i]] += 1;
        }

        var successes = {
            basic: 0,
            critical: 0,
            extreme: 0,
            impossible: 0,
        }

        for (k = 1; table.length > k; k++) {
            if (table[k] >= 5) {
                successes.impossible += 1;
            } else if(table[k] == 4) {
                successes.extreme += 1;
            } else if(table[k] == 3) {
                successes.critical += 1;
            } else if(table[k] == 2) {
                successes.basic += 1;
            }
        }
    
        let results = {
            pair_of_one: table[1],
            pair_of_two: table[2],
            pair_of_three: table[3],
            pair_of_four: table[4],
            pair_of_five: table[5],
            pair_of_six: table[6],
            basic_success: successes.basic,
            critical_success: successes.critical,
            extreme_success: successes.extreme,
            impossible_success: successes.impossible,
        };

        return results;
    }
</script>
